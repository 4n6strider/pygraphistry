<html>
<head>
<link href="css/main.css" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Nunito:300' rel='stylesheet' type='text/css'>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>


var SUBTITLE = '<p><a href="mailto:info@graphistry.com">Email</a> us for a tool preview</p>';

var NETFLOW = {
    title: 'Datacenter Netflow Communication Logs',
    nodes: 'Pairs of <i>(IP,protocol)</i>',
    edges: 'Bandwidth from <span style="color:green">low</span> to <span style="color:red">high</span>',
    mapper: 'opentsdb'
};

var TITLES = {
    Facebook: {
        title: 'Facebook friendships',
        nodes: 'People. Color indicates community and size shows popularity.',
        edges: 'Friendships',
        mapper: 'opentsdb'
    },
    Miserables: {
        title: 'Characters Crossing Paths in Les Miserables',
        nodes: 'Characters. Color indicates community and size shows popularity.',
        edges: 'Characters co-occurred.'
    },
    NetflowSmall: NETFLOW,
    NetflowMedium: NETFLOW,
    NetflowLarge: NETFLOW,
    NetflowHuge: NETFLOW,
    Enron: {
        title: 'Enron emails',
        nodes: 'People. Color indicates community and size shows popularity.',
        edges: 'Indicates email exchanged'
    },
    Oregon: {
        title: 'Autonomous System Peering (Oregon)',
        nodes: '',
        edges: ''
    },
    Wikivotes: {
        title: 'Wikipedia Editor Elections',
        nodes: 'User',
        edges: 'Vote cast by one user for another'
    },
    Amazon: {
        title: 'Amazon Product Co-Purchases',
        nodes: 'Product or a customer',
        edges: 'Product reviewd by a customer'
    },
    Gnutella: {
        title: 'Gnutella Peer-to-Peer Network',
        nodes: 'Hosts (computers)',
        edges: 'Communications'
    },
    Epinions: {
        title: 'Epinions Trust Relationships',
        nodes: 'Users',
        edges: 'Trust relationship'
    },
    Twitter: {
        title: 'Network of Twitter Fake Accounts',
        nodes: 'Accounts',
        edges: 'Follow relationship',
        mapper: 'opentsdb'
    }
};
for (var i in TITLES) {
    var o = TITLES[i];
    o.title ='<h3>' + o.title + '</h3>';
}



function jump() {

    var dataset = $('#dataset').val();
    var cfg = TITLES[dataset]  || {
            title: '<h3>Graph: ' + dataset + '</h3>',
            nodes: 'undefined',
            edges: 'undefined'
        };
    cfg.mapper = cfg.mapper || 'splunk';
    cfg.subtitle = cfg.subtitle || SUBTITLE;


    var controls = $('#controls').val();

    var args = [
        'dataset=' + encodeURIComponent(dataset),
        //'controls=' + controls,
        'scene=' + (controls === 'uber' ? 'uber' : 'netflow'),
        'info=true',
        'play=10000',
        'mapper=' + cfg.mapper,
        'legend=' + encodeURIComponent(JSON.stringify(cfg)),
    ];
    var url = '/graph/graph.html?' + args.join('&');
    window.open(url, '_blank');
}

</script>
<script>

function ping(k) {
    console.log('go');
    var t0 = Date.now();

    var xhr = new XMLHttpRequest();
    xhr.open('GET', 'mt.html', true);
    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4) {
            k(Date.now() - t0);
        }
    };
    xhr.send(null);
}

function pinger () {
    var timings = [];
    var loop = function (step) {
        if (step) {
            ping(function (v) {
                timings.push(v);
                loop(step - 1);
            });
        } else {
            var sum = 0;
            for (var i = 0; i < timings.length; i++) {
                sum += timings[i];
            }
            document.getElementById('ping').innerHTML =
                '<i>ping: ' + (sum/timings.length).toFixed(1) + 'ms rtt</i>';
        }
    };
    loop(10);
}


window.onload = pinger;
</script>


</head>
<body>

<div class="banner">
    <img src="img/logo.png" style="width: 300px;" />
    <div style="font-size:0.5em; font-weight: bold">LABS DEMOS</div>

    <div style="font-size:0.5em">
        <a href="mailto:info@graphistry.com">email</a> for tool preview
    </div>
</div>

<div class="content">
    <div class="regions">
        <div class="off">
            <span class="name">nyc</span>
            <span class="status">offline</span>
        </div>
        <div class="cali">
            <b>california</b>
            <div style="font-size: 0.5em; padding-top: 0.3em; text-align: center; line-height: 1.8em">
            <!--
                <a href="graph/uber.html?dataset=Uber&type=OBSOLETE_geo&scene=uber&controls=uber&info=true">uber</a>
            -->
                <a href="graph/graph.html?dataset=NetflowLarge&scene=netflow&mapper=opentsdb&info=true&play=10000&legend=%7B%22title%22%3A%22%3Ch2%3EDatacenter%20Netflow%20Traffic%20Logs%3C%2Fh2%3E%22%2C%22subtitle%22%3A%22%3Ch3%3E%3Ca%20href%3D%5C%22mailto%3Ainfo%40graphistry.com%5C%22%3Eemail%3C%2Fa%3E%20for%20a%20tool%20preview%3C%2Fh3%3E%22%2C%22nodes%22%3A%22Pair%20of%20(IP%2Cprotocol)%22%2C%22edges%22%3A%22Bandwidth%20from%20%3Cspan%20style%3D%5C%22color%3Agreen%5C%22%3Elow%3C%2Fspan%3E%20to%20%3Cspan%20style%3D%5C%22color%3Ared%5C%22%3Ehigh%3C%2Fspan%3E%22%7D">netflow logs</a> (<a href="graph/graph.html?dataset=NetflowHuge&scene=netflow&mapper=opentsdb&info=true&play=120000&legend=%7B%22title%22%3A%22%3Ch2%3EDatacenter%20Netflow%20Traffic%20Logs%3C%2Fh2%3E%22%2C%22subtitle%22%3A%22%3Ch3%3E%3Ca%20href%3D%5C%22mailto%3Ainfo%40graphistry.com%5C%22%3Eemail%3C%2Fa%3E%20for%20a%20tool%20preview%3C%2Fh3%3E%22%2C%22nodes%22%3A%22Pair%20of%20(IP%2Cprotocol)%22%2C%22edges%22%3A%22Bandwidth%20from%20%3Cspan%20style%3D%5C%22color%3Agreen%5C%22%3Elow%3C%2Fspan%3E%20to%20%3Cspan%20style%3D%5C%22color%3Ared%5C%22%3Ehigh%3C%2Fspan%3E%22%7D">huge: 2min</a>)

                <br/>
                <a href="graph/graph.html?dataset=Facebook&scene=netflow&info=true&play=10000&mapper=opentsdb&legend=%7B%22title%22%3A%22%3Ch3%3EFacebook%20friendships%3C%2Fh3%3E%22%2C%22nodes%22%3A%22People.%20Color%20indicates%20community%20and%20size%20shows%20popularity.%22%2C%22edges%22%3A%22Friendships%22%2C%22mapper%22%3A%22splunk%22%2C%22subtitle%22%3A%22%3Cp%3E%3Ca%20href%3D%5C%22mailto%3Ainfo%40graphistry.com%5C%22%3EEmail%3C%2Fa%3E%20us%20for%20a%20tool%20preview%3C%2Fp%3E%22%7D"> facebook friendships </a>

                <div id="ping" style="position: absolute; padding-left: 6em; padding-top: 0.2em; font-size: 0.8em"></div>
            </div>

        </div>
        <div class="off">
            <span class="name">tokyo</span>
            <span class="status">offline</span>
        </div>
        <div class="off">
            <span class="name">singapore</span>
            <span class="status">offline</span>
        </div>
    </div>

    <div class="loader">
        <h3>+ experimental datasets</h3>
        <span>
            <input id="dataset" list="datasets" type="text" size="64" name="url" value="Miserables" />
            <datalist id="datasets">
                <option value="Amazon">
                <option value="Enron">
                <option value="Epinions">
                <option value="Facebook">
                <option value="Gnutella">
                <option value="Miserables">
                <option value="NetflowSmall">
                <option value="NetflowMedium">
                <option value="NetflowLarge">
                <option value="NetflowHuge">
                <option value="Oregon">
                <option value="Twitter">
                <option value="Wikivotes">
            </datalist>
        </span>
        <!--
        <span> layout:
            <select id="controls" >
                <option value="atlas">Force Atlas 2</option>
                <option value="gauss">Gauss-Seidel</option>
                <option value="uber">Edge Bundling</option>
            </select>
        </span>
        -->
        <button type="button" onclick="jump();">go</button>
    </div>
</div>

</body>
</html>
