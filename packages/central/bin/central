#!/usr/bin/env node
'use strict';
/// <reference path="../typings/node/node.d.ts"/>

var config = JSON.parse(require('fs')
    .readFileSync('./node_modules/config/babel-config.json'));

config.presets = (config.presets || []).map(function(preset) {
    return require.resolve('babel-preset-' + preset);
});

require('babel-register')(config);

var server = require('../lib/server.js');
var logger = server.logger;

server.start().subscribe(
    function () {
        logger.info('Central listening on %s:%d', server.config.listenIP,
                                               server.config.listenPort);
    },
    function (err) {
        logger.error('Central failed to start server on %s:%s. Exiting...',
                  server.config.listenIP, server.config.listenPort, err);
        process.exit(1);
    }
);
